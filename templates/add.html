{% extends 'base.html' %}
{% block content %}
<h1>Añadir receta desde Instagram</h1>
<p>Pega la URL de un post público (p. ej. https://www.instagram.com/p/XXXXXXXX/ o /reel/XXXXXXXX/).</p>

<form method="post" class="mt-3">
  <div class="mb-3">
    <label for="url" class="form-label">URL del post</label>
    <input type="url" id="url" name="url" class="form-control" placeholder="https://www.instagram.com/p/..." required>
  </div>

  <div class="row g-3">
    <div class="col-md-6">
      <label for="title" class="form-label">Título (opcional)</label>
      <input type="text" id="title" name="title" class="form-control" placeholder="Ej: Tarta de queso rápida">
    </div>
  </div>

  <div class="mt-3">
    <label for="folder_select" class="form-label">Carpeta</label>
    <select id="folder_select" name="folder_select" class="form-select" onchange="onFolderChange(this)">
      <option value="none">-- Ninguna --</option>
      {% for f in folders %}
      <option value="{{ f }}">{{ f }}</option>
      {% endfor %}
      <option value="new">+ Crear nueva carpeta...</option>
    </select>
    <div id="new_folder_wrapper" style="display:none; margin-top:8px;">
      <label for="new_folder_name" class="form-label">Nombre nueva carpeta</label>
      <input type="text" id="new_folder_name" name="new_folder_name" class="form-control" placeholder="Nombre carpeta">
    </div>
  </div>

  <div class="mt-4">
    <button type="submit" class="btn btn-primary">Añadir receta</button>
    <a href="{{ url_for('index') }}" class="btn btn-secondary">Volver</a>
  </div>
</form>

<script>
function toggleNewFolder(show) { document.getElementById('new_folder_wrapper').style.display = show ? 'block' : 'none'; }
function onFolderChange(sel) { if (sel.value === 'new') toggleNewFolder(true); else toggleNewFolder(false); }
window.addEventListener('DOMContentLoaded', function () {
  const sel = document.getElementById('folder_select'); if (sel) onFolderChange(sel);
});
</script>
{% endblock %}
