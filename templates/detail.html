{% extends 'base.html' %}
{% block content %}
<h1>{{ r.title or "Receta" }}</h1>

<div class="mb-3">
{% if r.video_path %}
<video controls preload="auto" style="max-width:100%; height:auto;">
  <source src="{{ url_for('static', filename='uploads/' + r.video_path) }}" type="video/mp4">
</video>
{% elif r.image_path %}
<img src="{{ url_for('static', filename='uploads/' + r.image_path) }}" alt="imagen receta" class="img-fluid">
{% endif %}
</div>

<p><strong>Autor:</strong> {{ r.author }}</p>

<p><strong>Carpeta:</strong> {{ r.folder or 'General' }}</p>

<!-- Formulario para cambiar carpeta -->
<form method="post" action="{{ url_for('change_recipe_folder', recipe_id=r.id) }}" class="mb-3">
  <div class="input-group" style="max-width:300px;">
    <select name="folder_select" class="form-select">
      {% for f in folders %}
      <option value="{{ f }}" {% if f == r.folder %}selected{% endif %}>{{ f }}</option>
      {% endfor %}
      <option value="Otros" {% if r.folder == 'Otros' %}selected{% endif %}>Otros</option>
    </select>
    <button type="submit" class="btn btn-primary">Cambiar</button>
  </div>
</form>

<p><strong>Publicado:</strong> {{ r.posted_at }}</p>
<p><strong>Likes:</strong> {{ r.likes }}</p>
<p><strong>Descripción:</strong> {{ r.caption }}</p>

<a href="{{ r.url }}" target="_blank" class="btn btn-outline-primary">Ver en Instagram</a>
<form method="post" action="{{ url_for('delete', recipe_id=r.id) }}" class="d-inline" onsubmit="return confirm('¿Estás seguro de que quieres eliminar esta receta?');">
  <button type="submit" class="btn btn-danger">Eliminar</button>
</form>
<a href="{{ url_for('index') }}" class="btn btn-secondary">Volver</a>
{% endblock %}
